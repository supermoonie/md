---
title: MQ
date: 2022-03-13 21:59:22
tags:
- mq
---

### 如何保证消息不被重复消费（幂等性）

每个消息都有唯一的消息id或者业务id：

1. 先查询再保存
2. 业务表添加条件约束
3. 添加消息表，消息ID添加唯一约束
4. 使用redis，对消息id进行加锁

<!-- more -->

### 如何保证生产者发送消息的可靠性

1. 消息的持久化
2. 事务
3. ack

### 死信队列

一条消息在被重发多次后（6），将会被ActiveMQ移入死信队列。
