---
title: MySql
date: 2022-03-13 22:46:18
tags:
- MySql
---

### binlog 的三种格式：

- statement：每一条会修改数据的sql都会记录在binlog中，日志量小，主从复制时存储过程、函数或者触发器可能无法复制
- row：不记录sql上下文相关信息，仅保存哪些记录被修改，日志量打，不会出现函数等无法复制的问题
- mixed：以上两种的混合使用，一般的语句修改使用statement格式保存binlog，函数等无法完成复制的，采用row格式

### MySql MVCC (Multi-Version Concurrency Control)

### InnoDB锁的三种算法

- Record Lock：记录锁，单个行记录上的锁
- Gap Lock：间隙锁，锁定一个范围，不包括记录本身
- Next-Key Lock：record + gap间隙锁，锁定一个范围，包含记录本身

### B树和B+树（多路平衡查找树）的区别：

- B树的所有节点既存放键也存放数据；B+树只有叶子结点存放键和数据，其他内节点只存放键
- B树的叶子结点都是独立的；B+树的叶子结点有一条引用链指向它相邻的叶子结点
- B树的检索是对关键字二分查找，可能没到达叶子结点就结束了；B+树的检索都是从跟结点到叶子节点d的过程

### 索引类型

- 主键索引
- 二级（辅助）索引：二级索引的叶子节点存储的数据是主键

### 聚集索引与非聚集索引

- 聚集索引：索引结构和数据一起存放的索引
    - 优点：查询速度快
    - 缺点：
        1. 依赖有序的数据
        2. 更新代价大
- 非聚集索引：
    - 优点：更新代价小
    - 缺点：
        1. 依赖有序的数据
        2. 可能会二次查询（回表）

